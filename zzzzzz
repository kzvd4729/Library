#include<bits/stdc++.h>
#define long long long
using namespace std;
const int N=1e5;
map<string,int>mp;
int vis[N+2];
struct data
{
  char ty;int id1,id2;
  vector<int>v;
  data()
  {
    id1=-1;id2=-1;
  }
}aa[N+2];vector<data>v;
int match(int i,int j)
{
  int ret=0;set<int>st;
  for(auto x:aa[i].v)
    st.insert(x);
  for(auto x:aa[j].v)
    if(st.find(x)!=st.end())ret++;
  return ret;
}
int score(int i,int j)
{
  int ret=0;set<int>st;
  for(auto x:v[i].v)
    st.insert(x);
  for(auto x:v[j].v)
    if(st.find(x)!=st.end())ret++;
  ret=min(ret,(int)v[i].v.size()-ret);
  ret=min(ret,(int)v[j].v.size()-ret);
  return ret;
}
int main()
{
  //ios_base::sync_with_stdio(0);cin.tie(0);
  freopen("b_lovely_landscapes.txt","r",stdin);
  freopen("outputB.txt","w",stdout);

  mt19937 rng(chrono::steady_clock::now().time_since_epoch().count());
  int n;cin>>n;int id=0;
  for(int i=1;i<=n;i++)
  {
    cin>>aa[i].ty;int x;cin>>x;aa[i].id1=i;
    while(x--)
    {
      string s;cin>>s;
      if(!mp[s])mp[s]=++id;
      aa[i].v.push_back(mp[s]);
    }
  }
  id=0;
  for(int i=1;i<=n;i++)
  {
    if(vis[i])continue;
    if(aa[i].ty=='H')
    {
      v.push_back(aa[i]);continue;
    }
    int mn=1e9,er=-1;
    for(int j=i+1;j<=n;j++)
    {
      if(vis[j]||aa[j].ty=='H')continue;
      int tmp=match(i,j);
      if(tmp<mn)mn=tmp,er=j;
    }
    if(er!=-1)
    {
      for(auto x:aa[er].v)
        aa[i].v.push_back(x);
      aa[i].id2=aa[er].id1;
      sort(aa[i].v.begin(),aa[i].v.end());
      aa[i].v.erase(unique(aa[i].v.begin(),aa[i].v.end()),aa[i].v.end());
      v.push_back(aa[i]);vis[er]=1;
    }
  }
  shuffle(v.begin(),v.end(),rng);
  shuffle(v.begin(),v.end(),rng);
  //shuffle(v.begin(),v.end(),rng);

  int tt=0;
  for(int i=0;i<n-1;i++)
  {
    int mx=0;
    for(int j=i+1;j<n;j++)
    {
      if(score(i,j)>mx)
      {
        mx=score(i,j);swap(v[i+1],v[j]);
      }
    }
    tt+=mx;
  }
  cout<<v.size()<<endl;
  for(auto x:v)
  {
    cout<<x.id1-1;
    if(x.id2==-1)cout<<endl;
    else cout<<" "<<x.id2-1<<endl;
  }
  //cout<<tt<<endl;
  return 0;
}
